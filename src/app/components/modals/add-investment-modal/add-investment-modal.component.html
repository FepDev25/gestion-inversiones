<div *ngIf="isVisible" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-md">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-xl font-semibold text-gray-800">Nueva Inversión</h3>
      <button (click)="onCancel()" class="text-gray-500 hover:text-gray-700">
        <fa-icon [icon]="['fas', 'times']"></fa-icon>
      </button>
    </div>

    <form (ngSubmit)="onSubmit()" #investmentForm="ngForm" class="space-y-4">
      <div>
        <label for="investment-name" class="block text-gray-700 mb-2">Nombre</label>
        <input type="text" id="investment-name" name="investmentName" [(ngModel)]="investmentName" required
               class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
      </div>

      <div>
        <label for="investment-type" class="block text-gray-700 mb-2">Tipo</label>
        <select id="investment-type" name="investmentType" [(ngModel)]="investmentType"
                class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          <option *ngFor="let typeOpt of investmentTypes" [value]="typeOpt">
            {{ typeOpt.charAt(0).toUpperCase() + typeOpt.slice(1).replace('-', ' ') }}
          </option>
        </select>
      </div>

      <div>
        <label for="investment-amount" class="block text-gray-700 mb-2">Capital Invertido ($)</label>
        <input type="number" id="investment-amount" name="investmentAmount" [(ngModel)]="investmentAmount" required min="0.01"
               class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
      </div>

      <div>
        <label for="monthly-earning" class="block text-gray-700 mb-2">Ganancia Mensual ($)</label>
        <input type="number" id="monthly-earning" name="monthlyEarning" [(ngModel)]="monthlyEarning" required
               class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
      </div>

      <div>
        <label for="investment-description" class="block text-gray-700 mb-2">Descripción (opcional)</label>
        <textarea id="investment-description" name="investmentDescription" [(ngModel)]="investmentDescription" rows="3"
                  class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
      </div>

      <!-- Conditional fields based on investmentType -->
      <div *ngIf="investmentType === 'stocks'" class="space-y-4 border-t border-gray-200 pt-4 mt-4">
        <h4 class="text-md font-semibold text-gray-700">Detalles de Acciones</h4>
        <div>
          <label for="ticker-symbol" class="block text-gray-700 mb-2">Símbolo (Ticker)</label>
          <input type="text" id="ticker-symbol" name="tickerSymbol" [(ngModel)]="tickerSymbol" required
                 class="w-full p-2 border border-gray-300 rounded-md">
        </div>
        <div>
          <label for="shares" class="block text-gray-700 mb-2">Cantidad de Acciones</label>
          <input type="number" id="shares" name="shares" [(ngModel)]="shares" required min="1"
                 class="w-full p-2 border border-gray-300 rounded-md">
        </div>
        <div>
          <label for="acquisition-percentage" class="block text-gray-700 mb-2">Porcentaje de Adquisición (Ej: 0.5 para 50%)</label>
          <input type="number" id="acquisition-percentage" name="acquisitionPercentage" [(ngModel)]="acquisitionPercentage" required min="0" max="1" step="0.01"
                 class="w-full p-2 border border-gray-300 rounded-md">
        </div>
      </div>

      <div *ngIf="investmentType === 'crypto'" class="space-y-4 border-t border-gray-200 pt-4 mt-4">
        <h4 class="text-md font-semibold text-gray-700">Detalles de Criptomonedas</h4>
        <div>
          <label for="crypto-name" class="block text-gray-700 mb-2">Nombre de la Criptomoneda</label>
          <input type="text" id="crypto-name" name="cryptoName" [(ngModel)]="cryptoName" required
                 class="w-full p-2 border border-gray-300 rounded-md">
        </div>
        <div>
          <label for="wallet-address" class="block text-gray-700 mb-2">Dirección de Wallet (Opcional)</label>
          <input type="text" id="wallet-address" name="walletAddress" [(ngModel)]="walletAddress"
                 class="w-full p-2 border border-gray-300 rounded-md">
        </div>
      </div>

      <div *ngIf="investmentType === 'real-estate'" class="space-y-4 border-t border-gray-200 pt-4 mt-4">
        <h4 class="text-md font-semibold text-gray-700">Detalles de Bienes Raíces</h4>
        <div>
          <label for="property-address" class="block text-gray-700 mb-2">Dirección de la Propiedad</label>
          <input type="text" id="property-address" name="propertyAddress" [(ngModel)]="propertyAddress" required
                 class="w-full p-2 border border-gray-300 rounded-md">
        </div>
        <div>
          <label for="property-type" class="block text-gray-700 mb-2">Tipo de Propiedad</label>
          <select id="property-type" name="propertyType" [(ngModel)]="propertyType" required
                  class="w-full p-2 border border-gray-300 rounded-md">
            <option *ngFor="let pt of propertyTypes" [value]="pt">{{ pt.charAt(0).toUpperCase() + pt.slice(1) }}</option>
          </select>
        </div>
      </div>

      <div *ngIf="investmentType === 'bonds'" class="space-y-4 border-t border-gray-200 pt-4 mt-4">
        <h4 class="text-md font-semibold text-gray-700">Detalles de Bonos</h4>
        <div>
          <label for="issuer-name" class="block text-gray-700 mb-2">Nombre del Emisor</label>
          <input type="text" id="issuer-name" name="issuerName" [(ngModel)]="issuerName" required
                 class="w-full p-2 border border-gray-300 rounded-md">
        </div>
        <div>
          <label for="maturity-date" class="block text-gray-700 mb-2">Fecha de Vencimiento</label>
          <input type="date" id="maturity-date" name="maturityDate" [(ngModel)]="maturityDate" required
                 class="w-full p-2 border border-gray-300 rounded-md">
        </div>
        <div>
          <label for="coupon-rate" class="block text-gray-700 mb-2">Tasa de Cupón (Ej: 0.05 para 5%)</label>
          <input type="number" id="coupon-rate" name="couponRate" [(ngModel)]="couponRate" required min="0" max="1" step="0.001"
                 class="w-full p-2 border border-gray-300 rounded-md">
        </div>
      </div>

      <div *ngIf="investmentType === 'business'" class="space-y-4 border-t border-gray-200 pt-4 mt-4">
        <h4 class="text-md font-semibold text-gray-700">Detalles de Negocio</h4>
        <div>
          <label for="business-name" class="block text-gray-700 mb-2">Nombre del Negocio</label>
          <input type="text" id="business-name" name="businessName" [(ngModel)]="businessName" required
                 class="w-full p-2 border border-gray-300 rounded-md">
        </div>
        <div>
          <label for="stake-percentage" class="block text-gray-700 mb-2">Porcentaje de Participación (Ej: 0.2 para 20%)</label>
          <input type="number" id="stake-percentage" name="stakePercentage" [(ngModel)]="stakePercentage" required min="0" max="1" step="0.01"
                 class="w-full p-2 border border-gray-300 rounded-md">
        </div>
      </div>
      <!-- End conditional fields -->

      <div class="flex justify-end space-x-3 mt-6">
        <button type="button" (click)="onCancel()" class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100">
          Cancelar
        </button>
        <button type="submit" [disabled]="investmentForm.invalid || !investmentAmount || investmentAmount <= 0"
                class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50">
          Guardar
        </button>
      </div>
    </form>
  </div>
</div>
